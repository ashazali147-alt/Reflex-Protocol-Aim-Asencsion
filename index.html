<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reflex Protocol: Aim Asencsion</title>

  <style>
    :root {
      --bg-dark: #0f0f0f;
      --bg-light: #f0f0f0;
      --text-dark: #ffffff;
      --text-light: #000000;
      --neon: #00ffff;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      background-color: var(--bg-dark);
      color: var(--text-dark);
      transition: background 0.5s, color 0.5s;
    }

    .neon {
      text-shadow: 0 0 5px var(--neon), 0 0 10px var(--neon), 0 0 20px var(--neon);
      color: var(--neon);
    }

    section {
      text-align: center;
      padding: 40px;
    }

    select, button {
      margin-top: 20px;
      padding: 12px 20px;
      font-size: 1rem;
      border-radius: 50px;
      border: none;
      background-color: var(--neon);
      color: black;
      cursor: pointer;
      box-shadow: 0 0 10px var(--neon);
    }

    #game-area {
      position: relative;
      height: 500px;
      background-color: #111;
      overflow: hidden;
      display: none;
      flex-direction: row;
    }

    #scoreboard {
      width: 200px;
      padding: 20px;
      text-align: left;
      font-size: 1.2rem;
      border-right: 2px solid var(--neon);
      background: rgba(255,255,255,0.05);
    }

    #target-zone {
      flex-grow: 1;
      position: relative;
    }

    .target {
      position: absolute;
      width: 50px;
      height: 50px;
      background-color: var(--neon);
      border-radius: 50%;
      box-shadow: 0 0 10px var(--neon);
      cursor: pointer;
    }

    #mode-toggle {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 8px 16px;
      border-radius: 20px;
      background-color: var(--neon);
      color: black;
      border: none;
      cursor: pointer;
    }

    /* cursor crosshair */
    #cursor-crosshair {
      position: fixed;
      width: 30px;
      height: 30px;
      border: 2px solid var(--neon);
      border-radius: 50%;
      pointer-events: none;
      transform: translate(-50%, -50%);
      z-index: 9999;
    }
  </style>
</head>
<body>

  <button id="mode-toggle" onclick="toggleMode()">Toggle Mode</button>

  <!-- Splash Screen -->
  <section id="splash-screen">
    <h1 class="neon">Reflex Protocol: Aim Ascension</h1>

    <h3 class="neon">Crosshair Style:</h3>
    <select id="crosshair-select">
      <option value="default">Default</option>
      <option value="small">Small Red</option>
      <option value="large">Large Green</option>
      <option value="outline">Neon Outline</option>
    </select>

    <label for="difficulty">Select Difficulty:</label>
    <select id="difficulty">
      <option value="easy">Easy</option>
      <option value="chaos">Chaos</option>
      <option value="legacy">Legacy Mode</option>
    </select>

    <br />
    <button onclick="startGame()">Begin Trial</button>
  </section>

  <!-- Game Area -->
  <section id="game-area">
    <div id="scoreboard">
      <p>Score: <span id="score">0</span></p>
      <p>Misses: <span id="misses">0</span></p>
      <p>Accuracy: <span id="accuracy">100</span>%</p>
      <p>Time Left: <span id="timer">30</span>s</p>
      <p>Streak: <span id="streak">0</span></p>
      <p>Legacy Multiplier: <span id="legacy-multi">1.0x</span></p>
    </div>

    <div id="target-zone"></div>

    <button id="end-btn" onclick="endGame()" style="position:absolute; top:10px; left:50%; transform:translateX(-50%);">End Trial</button>
  </section>

  <!-- Results -->
  <section id="results" style="display:none;">
    <h2 class="neon">Trial Complete</h2>
    <p>Final Score: <span id="final-score"></span></p>
    <p>Misses: <span id="final-misses"></span></p>
    <p>Accuracy: <span id="final-accuracy"></span>%</p>
    <p>Difficulty: <span id="final-difficulty"></span></p>
    <button onclick="location.reload()">Retry</button>
  </section>

<script>
  let score = 0;
  let misses = 0;
  let streak = 0;
  let timeLeft = 30;
  let gameInterval;
  let mode = "dark";
  let legacyMultiplier = 1.0;

  const crosshairStyles = {
    default: { size: 30, color: 'transparent', border: '2px solid var(--neon)' },
    small: { size: 20, color: '#ff0000', border: '2px solid white' },
    large: { size: 50, color: '#00ff00', border: '3px solid black' },
    outline: { size: 40, color: 'transparent', border: '3px solid var(--neon)' }
  };

  function applyCrosshairStyle(name) {
    const style = crosshairStyles[name];
    const cross = document.getElementById("cursor-crosshair");
    cross.style.width = style.size + "px";
    cross.style.height = style.size + "px";
    cross.style.background = style.color;
    cross.style.border = style.border;
  }

  document.getElementById("crosshair-select").addEventListener("change", e => applyCrosshairStyle(e.target.value));

  function toggleMode() {
    if (mode === "dark") {
      document.body.style.backgroundColor = "var(--bg-light)";
      document.body.style.color = "var(--text-light)";
      mode = "light";
    } else {
      document.body.style.backgroundColor = "var(--bg-dark)";
      document.body.style.color = "var(--text-dark)";
      mode = "dark";
    }
  }

  function startGame() {
    document.getElementById("splash-screen").style.display = "none";
    document.getElementById("game-area").style.display = "flex";

    timeLeft = 30;
    score = 0;
    misses = 0;
    streak = 0;

    countdown();
    gameInterval = setInterval(spawnTarget, 800);
  }

  function endGame() {
    clearInterval(gameInterval);
    timeLeft = 0;
    showResults();
  }

  function spawnTarget() {
    const zone = document.getElementById("target-zone");
    const target = document.createElement("div");
    target.className = "target";

    let x = Math.random() * 700;
    let y = Math.random() * 400;
    let velX = (Math.random() - 0.5) * 4;
    let velY = (Math.random() - 0.5) * 4;

    target.style.top = y + "px";
    target.style.left = x + "px";

    target.onclick = () => {
      score++;
      streak++;
      legacyMultiplier += 0.05;
      updateStats();
      target.remove();
    };

    zone.appendChild(target);

    let lifetime = 0;
    const moveInterval = setInterval(() => {
      if (!target.parentElement) return clearInterval(moveInterval);

      x += velX;
      y += velY;

      if (x <= 0 || x >= 700) velX *= -1;
      if (y <= 0 || y >= 400) velY *= -1;

      target.style.left = x + "px";
      target.style.top = y + "px";

      lifetime++;
      if (lifetime >= 60) {
        if (target.parentElement) {
          misses++;
          streak = 0;
          legacyMultiplier = Math.max(1, legacyMultiplier - 0.1);
          updateStats();
          target.remove();
        }
        clearInterval(moveInterval);
      }
    }, 16);
  }

  function updateStats() {
    const total = score + misses;
    const accuracy = total > 0 ? Math.round((score / total) * 100) : 100;
    document.getElementById("score").textContent = Math.floor(score);
    document.getElementById("misses").textContent = misses;
    document.getElementById("accuracy").textContent = accuracy;
    document.getElementById("streak").textContent = streak;
    document.getElementById("legacy-multi").textContent = legacyMultiplier.toFixed(2) + "x";
  }

  function countdown() {
    const timer = document.getElementById("timer");
    const interval = setInterval(() => {
      timeLeft--;
      timer.textContent = timeLeft;
      if (timeLeft <= 0) {
        clearInterval(interval);
        clearInterval(gameInterval);
        showResults();
      }
    }, 1000);
  }

  function showResults() {
    document.getElementById("game-area").style.display = "none";
    document.getElementById("results").style.display = "block";

    const total = score + misses;
    const accuracy = total > 0 ? Math.round((score / total) * 100) : 100;
    document.getElementById("final-score").textContent = Math.floor(score);
    document.getElementById("final-misses").textContent = misses;
    document.getElementById("final-accuracy").textContent = accuracy;
    document.getElementById("final-difficulty").textContent = document.getElementById("difficulty").value;
  }

  // Crosshair follow cursor
  document.addEventListener("DOMContentLoaded", () => {
    const cross = document.createElement("div");
    cross.id = "cursor-crosshair";
    document.body.appendChild(cross);

    document.addEventListener("mousemove", (e) => {
      cross.style.left = e.clientX + "px";
      cross.style.top = e.clientY + "px";
    });
  });

  window.startGame = startGame;
  window.toggleMode = toggleMode;
  window.endGame = endGame;
</script>
